{多空趋势, V1.1.0, 2023-09-12}
N:=3;
NN:=MIN(BARSCOUNT(CLOSE),N);
CNN:=REF(CLOSE,NN);
FF:=(CLOSE-CNN)/CNN;
NC:FF,COLORSTICK;
{STICKLINE(FF>0,0,NC,0.01,0),COLORRED;
STICKLINE(FF<0,0,NC,0.01,0),COLORGREEN;};
{TO:OPEN-REF(OPEN,1);
TC:CLOSE-REF(CLOSE,1);}
MAXH:=MAX(HIGH,REF(CLOSE,1));
MINL:=MIN(LOW,REF(CLOSE,1));
DIFF:=IFF(OPEN>CLOSE,HIGH-CLOSE,HIGH-CLOSE);
TZ:OPEN-REF(CLOSE,1)-DIFF;
TD:CLOSE-MINL;